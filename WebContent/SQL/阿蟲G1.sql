alter session set deferred_segment_creation=false;
ALTER SESSION SET NLS_TIMESTAMP_FORMAT ='YYYY-MM-DD HH24:MI:SS' ;
ALTER SESSION SET NLS_DATE_FORMAT ='YYYY-MM-DD' ;

DROP TABLE SESSIONS;
DROP TABLE CINEMA;
DROP TABLE MEALS;
DROP TABLE FAREDISCOUNT;
DROP SEQUENCE SESSIONS_SEQ;
DROP SEQUENCE CINEMA_SEQ;
DROP SEQUENCE MEALS_SEQ;
DROP SEQUENCE FAREDISCOUNT_SEQ;

--------------------------------------------------------------------------------

CREATE TABLE CINEMA (
 CINEMA_NO                   VARCHAR2(20CHAR)                          NOT NULL,
 CINEMA_TYPE                 VARCHAR2(2000)                            NOT NULL,
 CINEMA_SIZE                 NUMBER(4)        CHECK (CINEMA_SIZE>= 0)  NOT NULL,
 CINEMA_NAME                 VARCHAR2(10CHAR)                          NOT NULL,
 CINEMA_CORRECT              NUMBER(5)        DEFAULT 0                NOT NULL,
 CINEMA_STATUS               VARCHAR2(20CHAR) DEFAULT '可用'            NOT NULL,
 CONSTRAINT CINEMA_CINNO_PK PRIMARY KEY (CINEMA_NO));
 
  CREATE SEQUENCE CINEMA_SEQ
 INCREMENT BY 1
 START WITH 1
 NOMAXVALUE
 NOCYCLE
 NOCACHE;
 
 -- INSERT INTO CINEMA VALUES ('字串'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'字串',0,'正常');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'DRAGON',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'BIGCAT',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'SMALLDOG',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'LARGERBUG',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'KITTY',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'DRAGON',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'SPADE',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'DIAMOND',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'HEART',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'CLUB',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'NOKIG',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'SMALL',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'MIDDLE',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'MIDDLEUP',0,'可用');
 INSERT INTO CINEMA VALUES ('CINEMA'||LPAD(CINEMA_SEQ.NEXTVAL,3,0),'座位格式未定',400,'MIDDLEDOWN',0,'可用');
 
--------------------------------------------------------------------------------
 
CREATE TABLE SESSIONS (
 SESSION_NO                  VARCHAR2(20CHAR)                          NOT NULL,
 MOVIE_NO                    NUMBER(10)                                NOT NULL,
-- 討論MOVIE_NO是否改成VARCHAR2
 CINEMA_NO                   VARCHAR2(20CHAR)                          NOT NULL,
 SESSION_START               TIMESTAMP                                 NOT NULL,
 SESSION_STATUS              VARCHAR2(2000CHAR)                        NOT NULL,
 SESSION_REMAINING           NUMBER(4)   CHECK (SESSION_REMAINING>= 0) NOT NULL,
 CONSTRAINT SESSION_SESNO_PK PRIMARY KEY (SESSION_NO),
 CONSTRAINT SESSIONS_CINNO_CINEMA_FK FOREIGN KEY (CINEMA_NO) REFERENCES CINEMA (CINEMA_NO)); 
 
CREATE SEQUENCE SESSIONS_SEQ
 INCREMENT BY 1
 START WITH 1
 NOMAXVALUE
 NOCYCLE
 NOCACHE;
 
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000001,'CINEMA001','2019-03-29 06-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000002,'CINEMA002','2019-03-29 08-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000003,'CINEMA003','2019-03-29 10-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000004,'CINEMA004','2019-03-29 12-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000005,'CINEMA005','2019-03-29 14-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000001,'CINEMA006','2019-03-29 16-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000002,'CINEMA007','2019-03-29 18-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000003,'CINEMA008','2019-03-29 20-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000004,'CINEMA009','2019-03-29 22-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000005,'CINEMA010','2019-03-29 01-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000001,'CINEMA011','2019-03-29 04-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000002,'CINEMA012','2019-03-30 06-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000003,'CINEMA013','2019-03-30 08-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000004,'CINEMA014','2019-03-30 10-00-00','座位格式未定',400);
 INSERT INTO SESSIONS VALUES ('TEST_SESSION'||LPAD(SESSIONS_SEQ.NEXTVAL, 8, '0'),00000005,'CINEMA015','2019-03-30 12-00-00','座位格式未定',400);
 
--------------------------------------------------------------------------------
 
 CREATE TABLE MEALS (
 MEALS_NO                   VARCHAR2(20CHAR)                           NOT NULL,
 MEALS_NAME                 VARCHAR2(50CHAR)                           NOT NULL,
 MEALS_PRICE_PRE            NUMBER(4)       CHECK (MEALS_PRICE_PRE>=0) NOT NULL,
 MEALS_PRICE_GEN            NUMBER(4)       CHECK (MEALS_PRICE_GEN>=0) NOT NULL,
 MEALS_BLOB                 BLOB                                       ,
 MEALS_STATUS               VARCHAR2(20CHAR)                           NOT NULL,
 CONSTRAINT MEALS_MEANO_PK PRIMARY KEY (MEALS_NO));
 
 CREATE SEQUENCE MEALS_SEQ
 INCREMENT BY 1
 START WITH 1
 NOMAXVALUE
 NOCYCLE
 NOCACHE;
 
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'爆米花(小)',50,40,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'爆米花(中)',75,60,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'爆米花(大)',100,80,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'可樂',35,25,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'紅茶',30,20,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'奶茶',30,20,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'綠茶',30,20,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'冬瓜茶',30,20,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'卡拉雞腿堡',70,55,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'麥香雞堡',60,50,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'麥香魚堡',60,50,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'甜不辣(小)',35,25,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'甜不辣(大)',50,40,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'薯條(小)',40,30,NULL,'銷售中');
 INSERT INTO MEALS VALUES ('MEALS'||LPAD(MEALS_SEQ.NEXTVAL, 3, '0'),'薯條(大)',60,50,NULL,'銷售中');
 
--------------------------------------------------------------------------------
 
 CREATE TABLE FAREDISCOUNT (
 FD_NO                       VARCHAR2(20CHAR)                          NOT NULL,
 FD_NARRATIVE                VARCHAR2(500CHAR)                         NOT NULL,
 FD_NAME                     VARCHAR2(50CHAR)                          NOT NULL,
 FD_OFFER                    NUMBER(5)                                 NOT NULL,
 FD_START                    DATE                                      NOT NULL,
 FD_END                      DATE                                      NOT NULL,
 FD_UPPER                    NUMBER(5)       CHECK(FD_UPPER>0)         NOT NULL,
 FD_LOWER                    NUMBER(5)       CHECK(FD_LOWER<=30)       NOT NULL,
 FD_BLOB                     BLOB                                              , 
 CONSTRAINT FAREDISCOUNT_FDNO_PK PRIMARY KEY (FD_NO));
 
 CREATE SEQUENCE FAREDISCOUNT_SEQ
 INCREMENT BY 1
 START WITH 1
 NOMAXVALUE
 NOCYCLE
 NOCACHE;
 
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'常駐團體優惠','小型團體',-10,'2019-02-07','2099-02-07',10,5,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'常駐團體優惠','中型團體',-20,'2019-02-07','2099-02-07',20,11,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'常駐團體優惠','大型團體',-30,'2019-02-07','2099-02-07',30,21,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2018節慶優惠','2018春節',-20,'2018-02-15','2018-02-21',9,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2018節慶優惠','2018白色情人節',-20,'2018-03-14','2018-03-15',2,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2018假期優惠','2018暑假',-10,'2018-07-01','2018-09-01',4,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2018節慶優惠','2018七夕',-20,'2018-08-17','2018-08-18',2,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2018節慶優惠','2018聖誕節',-20,'2018-12-24','2018-12-26',9,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2019節慶優惠','2019春節',-20,'2019-02-01','2099-02-10',9,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2019節慶優惠','2019白色情人節',-20,'2019-03-14','2019-03-15',2,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2019假期優惠','2019暑假',-10,'2019-07-01','2019-09-01',4,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2019節慶優惠','2019七夕',-20,'2019-08-07','2019-08-08',2,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2019節慶優惠','2019聖誕節',-20,'2019-12-24','2019-12-26',9,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2020節慶優惠','2020春節',-20,'2019-02-01','2099-02-10',9,1,NULL);
 INSERT INTO FAREDISCOUNT VALUES ('FD'||LPAD(FAREDISCOUNT_SEQ.NEXTVAL, 3, '0'),'2020節慶優惠','2020白色情人節',-20,'2020-01-24','2020-01-31',2,1,NULL);
 