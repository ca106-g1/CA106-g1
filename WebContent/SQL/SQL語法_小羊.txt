alter session set deferred_segment_creation=false;


DROP TABLE GROUPALL;
DROP TABLE GROUPMEM;
DROP TABLE REPORTRECORD;
DROP TABLE CHATRECORD;


--




DROP SEQUENCE GROUPALL_sqe;
DROP SEQUENCE GROUPMEM_sqe;
DROP SEQUENCE REPORTRECORD_sqe;
DROP SEQUENCE CHATRECORD_sqe;




-------------------------------------------�إߴ��Ϊ��------------------------------------

CREATE TABLE GROUPALL(

GROUPALL_ID       VARCHAR2(20CHAR)     NOT NULL,
MEMBER_NO      VARCHAR2(20CHAR)     NOT NULL,
SESSIONS_NO     VARCHAR2(20CHAR)     NOT NULL,	
GROUPALL_ADDTIME  TIMESTAMP    	    NOT NULL,
GROUPALL_ENDTIME  TIMESTAMP    	    NOT NULL,
GROUPALL_NAME     VARCHAR2(30CHAR)     NOT NULL,
GROUPALL_UPPER    NUMBER(10)	    CHECK(GROUP_UPPER<=30),
GROUPALL_LOWER    NUMBER(10)	    CHECK(GROUP_LOWER>=5),

CONSTRAINT GRO_PK PRIMARY KEY (GROUPALL_ID),

CONSTRAINT GRO_ALL_MEM_FK FOREIGN KEY(MEMBER_NO)
    REFERENCES MEMBER(MEMBER_NO),

CONSTRAINT GRO_ALL_SES_FK FOREIGN KEY(SESSIONS_NO)
    REFERENCES SESSIONS(SESSIONS_NO)



);


CREATE SEQUENCE GROUP_seq
INCREMENT BY 1
START WITH 10
NOMAXVALUE
NOCYCLE
NOCACHE;


INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION2', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION2', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'��B��',30,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION3', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�v��',19,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION3', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'��B��',25,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION2', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v',25,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION2', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v',30,15);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'��B��',25,15);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);
INSERT INTO GROUPALL VALUES (GROUP_seq.NEXTVAL , 'A123456','SESSION1', TO_DATE('2019-03-29','YYYY-MM-DD'), TO_DATE('2019-03-30','YYYY-MM-DD'),'�ݹq�v��B��',15,5);












---------------------------------------------�إߴ��Φ������Ӫ��----------------------------------

CREATE TABLE GROUPMEM(


GROUP_NO  	VARCHAR2(20CHAR)  NOT NULL,
MEMBER_NO 	VARCHAR2(20CHAR)  NOT NULL,
ORDER_NO  	VARCHAR2(20CHAR)  NOT NULL,
GROUP_SEATNO    VARCHAR2(400CHAR) NOT NULL,

CONSTRAINT GRO_MEM_GRO_ALL_FK FOREIGN KEY(GROUP_NO)
    REFERENCES GROUPALL(GROUP_NO),
    
CONSTRAINT GRO_MEM_MEM_FK FOREIGN KEY(MEMBER_NO)
    REFERENCES MEMBER(MEMBER_NO),
    
CONSTRAINT PK_EMPPERMISSIONDETAIL  PRIMARY KEY (GROUP_NO,MEMBER_NO)
);







---------------------------------------------�إ߲�Ѭ������-------------------------------------------

CREATE TABLE CHATRECORD(

CHAT_ID    VARCHAR2(40CHAR)  NOT NULL,
GROUP_ID   VARCHAR2(20CHAR)  NOT NULL,
MEMBER_NO  VARCHAR2(20CHAR)  NOT NULL,
CHAT_CON   VARCHAR2(100CHAR) NOT NULL,
CHAT_TIME  TIMESTAMP NOT NULL,


CONSTRAINT CHA_GRO_ALL_FK FOREIGN KEY(GROUP_ID)
    REFERENCES GROUPALL(GROUP_ID),
    
CONSTRAINT CHA_MEM_FK FOREIGN KEY(MEMBER_NO)
    REFERENCES MEMBER(MEMBER_NO),

CONSTRAINT CHA_PK PRIMARY KEY (CHAT_ID)
);


CREATE SEQUENCE CHAT_seq
INCREMENT BY 1
START WITH 10
NOMAXVALUE
NOCYCLE
NOCACHE;




-------------------------------------------�إ����|�������------------------------------------------------

CREATE TABLE REPORTRECORD(


GROUP_ID  	VARCHAR2(20CHAR)  NOT NULL,
MEMBER_NO 	VARCHAR2(20CHAR)  NOT NULL,
REPORT_TIME 	TIMESTAMP 	  NOT NULL,
REPORT_CON 	VARCHAR2(500CHAR) NOT NULL,
REPORT_STA 	NUMBER(1)         NOT NULL,
EMPLOYEE_NO  	VARCHAR2(20CHAR)  NOT NULL,


CONSTRAINT REP_EMP_FK FOREIGN KEY(EMPLOYEE_NO)
    REFERENCES EMPLOYEE(EMPLOYEE_NO),




CONSTRAINT REP_GRO_ALL_FK FOREIGN KEY(GROUP_ID)
    REFERENCES GROUPALL(GROUP_ID),    

CONSTRAINT REP_MEM_FK FOREIGN KEY(MEMBER_NO)
    REFERENCES MEMBER(MEMBER_NO),  
  
CONSTRAINT PK_EMPPERMISSIONDETAIL  PRIMARY KEY (GROUP_ID,MEMBER_NO)
);


----------------------------------------------------------�p��----------------------------------------

commit;